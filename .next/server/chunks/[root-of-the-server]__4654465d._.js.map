{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 172, "column": 0}, "map": {"version":3,"sources":["file:///home/mcka_ron/Documents/develop/scalable-ia/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\n// PrismaClient is attached to the `global` object in development to prevent\n// exhausting your database connection limit.\nconst globalForPrisma = global as unknown as { prisma: PrismaClient };\n\nexport const prisma = globalForPrisma.prisma || new PrismaClient();\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;\n\nexport default prisma;\n"],"names":[],"mappings":";;;;;;;;;;AAEA,4EAA4E;AAC5E,6CAA6C;AAC7C,MAAM,kBAAkB;AAEjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI;AAEpD,wCAA2C,gBAAgB,MAAM,GAAG;uCAErD","debugId":null}},
    {"offset": {"line": 194, "column": 0}, "map": {"version":3,"sources":["file:///home/mcka_ron/Documents/develop/scalable-ia/src/app/api/summary/route.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { NextResponse } from \"next/server\";\nimport OpenAI from \"openai\";\nimport { Client } from \"@upstash/qstash\";\nimport prisma from \"~/lib/prisma\";\n\n// Initialize QStash client\nconst qstashClient = new Client({\n  token: process.env.QSTASH_TOKEN || \"\",\n});\n\nexport async function POST(request: Request) {\n  try {\n    // Parse the request body\n    const body = await request.json();\n    const { text } = body;\n\n    // Initialize OpenAI client with API key from environment variable\n    const openai = new OpenAI({\n      apiKey: process.env.OPENAI_API_KEY,\n    });\n\n    const promptTranca = `\n      Necesito que hagas un resumen de la siguiente entrada:\n      ${text}\n\n      Sigue la siguiente estructura:\n      Resumen: \n      [resumen]\n\n      Puntos clave:\n      [puntos clave]\n\n\n      Formato html, usa negritas, cursivas, listas, etc para que el resumen sea más legible.\n      estiliza el texto con inner css para que los título (resumen y puntos clave) sean más visibles.\n    `;\n\n    const promptHardcore = `\n      Necesito que hagas un resumen de la siguiente entrada:\n      ${text}\n\n      Sigue la siguiente estructura:\n      Resumen: \n      [resumen]\n\n      Puntos clave:\n      [puntos clave]\n\n      Análisis:\n      [necesito que hagas un análisis de la entrada, que vaya desde sentimientos de quien lo escribe hasta un desgloce completo\n      en qué sirve esta información para entenderla psicología del autor, el resumen debe ser extenso y detallado]\n\n      Formato html, usa negritas, cursivas, listas, etc para que el resumen sea más legible.\n    `;\n\n    // Call OpenAI API\n    const chatCompletion = await openai.chat.completions.create({\n      messages: [\n        {\n          role: \"system\",\n          content:\n            \"Eres un asistente experto en hacer resúmenes detallados pero cortos.\",\n        },\n        { role: \"user\", content: promptTranca },\n      ],\n      model: \"gpt-3.5-turbo\",\n    });\n\n    // Get the response from OpenAI\n    const aiResponse = chatCompletion.choices[0].message.content;\n\n    // Store the summary in the database\n    const savedSummary = await prisma.summary.create({\n      data: {\n        text,\n        summary: aiResponse,\n      },\n    });\n\n    // Return the response\n    return NextResponse.json({\n      message: aiResponse,\n      summaryId: savedSummary.id,\n    });\n  } catch (error) {\n    console.error(\"API Error:\", error);\n    return NextResponse.json(\n      { error: \"Failed to process OpenAI request\" },\n      { status: 500 }\n    );\n  }\n}\n\n// New endpoint for QStash test message\nexport async function PUT(request: Request) {\n  try {\n    const body = await request.json();\n    const { message, destination } = body;\n\n    if (!message || !destination) {\n      return NextResponse.json(\n        { error: \"Message and destination are required\" },\n        { status: 400 }\n      );\n    }\n\n    // Send a message to QStash\n    const response = await qstashClient.publishJSON({\n      url: destination,\n      body: {\n        message: message,\n        timestamp: new Date().toISOString(),\n      },\n    });\n\n    return NextResponse.json({\n      success: true,\n      messageId: response.messageId,\n      message: \"Message queued successfully\",\n    });\n  } catch (error) {\n    console.error(\"QStash Error:\", error);\n    return NextResponse.json(\n      { error: \"Failed to send message to QStash\" },\n      { status: 500 }\n    );\n  }\n}\n\n// Add a new GET endpoint to retrieve summaries\nexport async function GET(request: Request) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const id = searchParams.get(\"id\");\n\n    if (id) {\n      // Get a specific summary\n      const summary = await prisma.summary.findUnique({\n        where: { id },\n      });\n\n      if (!summary) {\n        return NextResponse.json(\n          { error: \"Summary not found\" },\n          { status: 404 }\n        );\n      }\n\n      return NextResponse.json(summary);\n    } else {\n      // Get all summaries\n      const summaries = await prisma.summary.findMany({\n        orderBy: { createdAt: \"desc\" },\n      });\n\n      return NextResponse.json(summaries);\n    }\n  } catch (error) {\n    console.error(\"Database Error:\", error);\n    return NextResponse.json(\n      { error: \"Failed to retrieve summaries\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":"AAAA,oDAAoD;;;;;AACpD;AACA;AACA;AAAA;AACA;;;;;AAEA,2BAA2B;AAC3B,MAAM,eAAe,IAAI,4NAAA,CAAA,SAAM,CAAC;IAC9B,OAAO,QAAQ,GAAG,CAAC,YAAY,IAAI;AACrC;AAEO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,yBAAyB;QACzB,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,IAAI,EAAE,GAAG;QAEjB,kEAAkE;QAClE,MAAM,SAAS,IAAI,sMAAA,CAAA,UAAM,CAAC;YACxB,QAAQ,QAAQ,GAAG,CAAC,cAAc;QACpC;QAEA,MAAM,eAAe,CAAC;;MAEpB,EAAE,KAAK;;;;;;;;;;;;IAYT,CAAC;QAED,MAAM,iBAAiB,CAAC;;MAEtB,EAAE,KAAK;;;;;;;;;;;;;;IAcT,CAAC;QAED,kBAAkB;QAClB,MAAM,iBAAiB,MAAM,OAAO,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;YAC1D,UAAU;gBACR;oBACE,MAAM;oBACN,SACE;gBACJ;gBACA;oBAAE,MAAM;oBAAQ,SAAS;gBAAa;aACvC;YACD,OAAO;QACT;QAEA,+BAA+B;QAC/B,MAAM,aAAa,eAAe,OAAO,CAAC,EAAE,CAAC,OAAO,CAAC,OAAO;QAE5D,oCAAoC;QACpC,MAAM,eAAe,MAAM,sHAAA,CAAA,UAAM,CAAC,OAAO,CAAC,MAAM,CAAC;YAC/C,MAAM;gBACJ;gBACA,SAAS;YACX;QACF;QAEA,sBAAsB;QACtB,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,WAAW,aAAa,EAAE;QAC5B;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,cAAc;QAC5B,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAmC,GAC5C;YAAE,QAAQ;QAAI;IAElB;AACF;AAGO,eAAe,IAAI,OAAgB;IACxC,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,OAAO,EAAE,WAAW,EAAE,GAAG;QAEjC,IAAI,CAAC,WAAW,CAAC,aAAa;YAC5B,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAuC,GAChD;gBAAE,QAAQ;YAAI;QAElB;QAEA,2BAA2B;QAC3B,MAAM,WAAW,MAAM,aAAa,WAAW,CAAC;YAC9C,KAAK;YACL,MAAM;gBACJ,SAAS;gBACT,WAAW,IAAI,OAAO,WAAW;YACnC;QACF;QAEA,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,WAAW,SAAS,SAAS;YAC7B,SAAS;QACX;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iBAAiB;QAC/B,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAmC,GAC5C;YAAE,QAAQ;QAAI;IAElB;AACF;AAGO,eAAe,IAAI,OAAgB;IACxC,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,KAAK,aAAa,GAAG,CAAC;QAE5B,IAAI,IAAI;YACN,yBAAyB;YACzB,MAAM,UAAU,MAAM,sHAAA,CAAA,UAAM,CAAC,OAAO,CAAC,UAAU,CAAC;gBAC9C,OAAO;oBAAE;gBAAG;YACd;YAEA,IAAI,CAAC,SAAS;gBACZ,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CACtB;oBAAE,OAAO;gBAAoB,GAC7B;oBAAE,QAAQ;gBAAI;YAElB;YAEA,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CAAC;QAC3B,OAAO;YACL,oBAAoB;YACpB,MAAM,YAAY,MAAM,sHAAA,CAAA,UAAM,CAAC,OAAO,CAAC,QAAQ,CAAC;gBAC9C,SAAS;oBAAE,WAAW;gBAAO;YAC/B;YAEA,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CAAC;QAC3B;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mBAAmB;QACjC,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA+B,GACxC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}